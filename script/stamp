#!/usr/bin/env ratch

# update version stamps

# You can change these via the command line.
version = commandline['version'] || release.version
status  = commandline['status']  || release.status

# Update ROLLRC file.

main :stamp do
  if version != release.version or status != release.status
    build release.file
  end
end

#

file release.file do
  w = ''
  w << "#{release.name} #{version} #{status} #{Time.now.strftime('%Y-%m-%d')}"
  w << " #{release.default}" if release.default
  w << "\n"
  w << release.libpath.join("\n")

  if dryrun?
    puts release.file + ":"
    puts w
  else
    File.open(release.file, 'w'){|f| f << w}
    puts "#{release.file} updated."
  end
end
